name: OpenScap Workbench CI

# Controls when the action will run. Triggers the workflow on push or pull request
# events but only for the master branch
on: [push, pull_request]

jobs:
  build-windows:
    # The type of runner that the job will run on
    runs-on: windows-latest
    steps:
    # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
    - uses: actions/checkout@v2

    # *before_install* port
    - name: Install additional packages
      run: |
        vcpkg install curl libxml2 libxslt bzip2 pcre pthreads
        vcpkg integrate install

    # # Runs a set of commands using the runners shell
    # - name: Run openSCAP build process
    #   run: |
    #     git clone --depth 1 https://github.com/openscap/openscap.git -b master
    #     pushd openscap/build
    #     cmake -DENABLE_PROBES=FALSE ../
    #     make -j 4
    #     make install
    #     popd

    # Build OSX image
    - name: Build Windows image
      run: |
        cd build
        cmake ..

    # # Get tag release version (1.2.X etc,.)
    # - name: Get the release version
    #   id: get_version
    #   run: echo ::set-output name=VERSION::${GITHUB_REF/refs\/tags\//}

    # # Deploy package to release
    # - name: Release
    #   uses: softprops/action-gh-release@v1
    #   if: startsWith(github.ref, 'refs/tags/')
    #   with:
    #     files: build-osx/scap-workbench-${{ steps.get_version.outputs.VERSION }}.dmg
    #   env:
    #     GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

